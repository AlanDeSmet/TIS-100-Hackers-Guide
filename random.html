<!DOCTYPE html><html lang="en"><head><meta charset="utf-8">
<title>math.random() and math.randomseed() - TIS-100 Hacker's Guide</title>
<meta content='True' name='HandheldFriendly' />  
<meta content='width=device-width; initial-scale=1.0;' name='viewport' />  
<meta name="viewport" content="width=device-width" />
<link href='https://fonts.googleapis.com/css?family=Roboto:400,700,400italic,700italic|Michroma|Roboto+Condensed|Roboto+Mono:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="index.css" type="text/css">
</head>
<body>

<h1 class="sitetitle"> <a class="sitetitle" href="index.html">TIS-100 Hacker's Guide</a><br> </h1>
<h1> math.random() and math.randomseed() </h1>

<p>In <a href="lua.html">Puzzle Lua</a> <code>math.random(min,max)</code> and <code>math.randomseed(seed)</code> are not from the main Lua distribution, which is based on the C library's <code>rand()</code> and <code>srand(int)</code>.</p>

<p>Instead they probably come from <a href="http://www.moonsharp.org/">MoonSharp</a>, a Lua interpreter written in C#.  That is probably calling into Unity's System.Random.  That is probably based on C#'s <a href="http://referencesource.microsoft.com/#mscorlib/system/random.cs,bb77e610694e64ca">random.cs</a>. That, and thus TIS-100, is based on <code>ran3()</code> from <em>Numerical Recipes in C, Second Edition</em>.  <em>That</em> is based on a random number generator by Donald Knuth in <em>Seminumerical Algorithms, second edition</em>, volume 2 of <em>The Art of Computer Programming</em>, sections 3.2-3.3.</p>

<p>There are two differences from the <em>Numerical Recipes</em> version (besides the interface).  First, MBIG has been replaced with 2147483647 , which is 2<sup>31</sup>-1, or the largest 32-bit signed integer using two's complement.  Second, the outer labs() call in the initial calculation of mj was removed.</p>

<p>Like Lua's math.random, the order of the arguments doesn't matter.  Similarly to Lua, if a single argument is given, it behaves as tough the second argument is 1.  <em>Unlike</em> Lua, a single negative argument is valid, so math.random(-2) is equivalent to math.random(-2,1), while official Lua would fail with "bad argument #1 to 'random' (interval is empty)".</p>

<ul>
<li><a href="random/random.c">random.c</a> <a href="random/random.h">random.h</a> - Implementation of TIS-100's random number generator in C
</li>
<li><a href="random/random.lua">random.lua</a> - Implementation of TIS-100's random number generator in Lua
</li>
</ul>

<p><a href="https://github.com/AlanDeSmet/TIS-100-Hackers-Guide/tree/gh-pages">A small test suit for a C or Lua implementation of the random functions is available in the "random" subdirectory in this project at GitHub.</a></p>

<p>Many thanks to Rohansi on Reddit for discovering the MoonSharp to Unity to C# link and pointing me at the C# implementation.  Thanks to AapOpSokken on Reddit for catching that the labs() was removed.</p>


<div class="copyright">
<p><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="float:right" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
<span class="copyrightlabel">Copyright</span>
Copyright 2015 Alan De Smet.
This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
<a href="https://github.com/AlanDeSmet/TIS-100-Hackers-Guide/tree/gh-pages">Fork this on GitHub!</a></p>
</div>

</body>
</html>
